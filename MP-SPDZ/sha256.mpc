from Compiler.GC.types import sbits, sbitintvec
from circuit import Circuit

# sha256: 2 512 256
# sha512: 2 1024 512

siv256 = sbitintvec.get_type(256)
siv512 = sbitintvec.get_type(512)
sb512 = sbits.get_type(512)
# 64 aa bytes (512 bits)
msg = siv512(sb512(0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa))
sha256 = Circuit('sha256')
iv = siv256(0x6a09e667bb67ae853c6ef372a54ff53a510e527f9b05688c1f83d9ab5be0cd19)
digest = sha256(msg, iv)
chunk = siv512(sb512((1 << 511) + 512))
digest = sha256(chunk, digest)
digest.elements()[0].reveal().print_reg()